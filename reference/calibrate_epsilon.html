<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calibrate Epsilon for PIPE Estimator — calibrate_epsilon • gPIPE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calibrate Epsilon for PIPE Estimator — calibrate_epsilon"><meta property="og:description" content="This function performs a calibration process to find the optimal epsilon value
for the Product of Independent Beta Probabilities Escalation (PIPE) design.
It evaluates different epsilon values across multiple simulated trials and selects
the value that maximizes the true positive rate while maintaining the false discovery
rate below a specified threshold."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gPIPE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/gPIPE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/xlai/gPIPE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calibrate Epsilon for PIPE Estimator</h1>
    <small class="dont-index">Source: <a href="https://github.com/xlai/gPIPE/blob/v0.1.0/R/utils-calibrateEpsilon.R" class="external-link"><code>R/utils-calibrateEpsilon.R</code></a></small>
    <div class="hidden name"><code>calibrate_epsilon.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs a calibration process to find the optimal epsilon value
for the Product of Independent Beta Probabilities Escalation (PIPE) design.
It evaluates different epsilon values across multiple simulated trials and selects
the value that maximizes the true positive rate while maintaining the false discovery
rate below a specified threshold.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calibrate_epsilon</span><span class="op">(</span></span>
<span>  <span class="va">dose_configs_valid</span>,</span>
<span>  <span class="va">epsilon_range</span>,</span>
<span>  <span class="va">num_simulations</span>,</span>
<span>  <span class="va">drugCombinationModel</span>,</span>
<span>  <span class="va">drugcombi_new</span>,</span>
<span>  <span class="va">patientDataModel</span>,</span>
<span>  fdr_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  user_defined_scenario <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_fdr_tpr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-dose-configs-valid">dose_configs_valid<a class="anchor" aria-label="anchor" href="#arg-dose-configs-valid"></a></dt>
<dd><p>List of valid dose configurations</p></dd>


<dt id="arg-epsilon-range">epsilon_range<a class="anchor" aria-label="anchor" href="#arg-epsilon-range"></a></dt>
<dd><p>Numeric vector of epsilon values to test</p></dd>


<dt id="arg-num-simulations">num_simulations<a class="anchor" aria-label="anchor" href="#arg-num-simulations"></a></dt>
<dd><p>Integer number of simulations to run for each epsilon value</p></dd>


<dt id="arg-drugcombinationmodel">drugCombinationModel<a class="anchor" aria-label="anchor" href="#arg-drugcombinationmodel"></a></dt>
<dd><p>DrugCombinationModel object containing the model parameters</p></dd>


<dt id="arg-drugcombi-new">drugcombi_new<a class="anchor" aria-label="anchor" href="#arg-drugcombi-new"></a></dt>
<dd><p>DrugCombi object representing the drug combinations</p></dd>


<dt id="arg-patientdatamodel">patientDataModel<a class="anchor" aria-label="anchor" href="#arg-patientdatamodel"></a></dt>
<dd><p>PatientDataModel object for tracking patient data</p></dd>


<dt id="arg-fdr-threshold">fdr_threshold<a class="anchor" aria-label="anchor" href="#arg-fdr-threshold"></a></dt>
<dd><p>Numeric value for the maximum acceptable false discovery rate (default: 0.05)</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>Numeric value representing the toxicity increment for non-MTD doses (default: 0.2)</p></dd>


<dt id="arg-user-defined-scenario">user_defined_scenario<a class="anchor" aria-label="anchor" href="#arg-user-defined-scenario"></a></dt>
<dd><p>Optional user-defined scenario to test instead of dose_configs_valid</p></dd>


<dt id="arg-return-fdr-tpr">return_fdr_tpr<a class="anchor" aria-label="anchor" href="#arg-return-fdr-tpr"></a></dt>
<dd><p>Logical indicating whether to return FDR and TPR results (default: TRUE)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing:</p><ul><li><p>optimal_epsilon: The optimal epsilon value that satisfies the FDR threshold</p></li>
<li><p>fdr_results: Vector of false discovery rates for each tested epsilon value</p></li>
<li><p>tpr_results: Vector of true positive rates for each tested epsilon value</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function tests each epsilon value in <code>epsilon_range</code> by running <code>num_simulations</code>
trial simulations. For each simulation, it:</p><ol><li><p>Creates an adjusted probability vector based on the true dose configuration</p></li>
<li><p>Runs a simulated trial with the current epsilon value</p></li>
<li><p>Calculates the false discovery rate (FDR) and true positive rate (TPR)</p></li>
</ol><p>The optimal epsilon is selected as the highest value that keeps the FDR below the
specified threshold. This balances between being conservative (lower epsilon values)
and efficient (higher true positive rates).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="PipeEstimator-class.html">PipeEstimator</a></code> for the class that uses epsilon in the PIPE methodology</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create required objects</span></span></span>
<span class="r-in"><span><span class="va">drug_combo_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="createDrugCombinationModel.html">createDrugCombinationModel</a></span><span class="op">(</span><span class="st">"config.yaml"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">drug_combi</span> <span class="op">&lt;-</span> <span class="fu"><a href="createDrugCombi.html">createDrugCombi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va"><a href="Drug-class.html">Drug</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>, <span class="va"><a href="Drug-class.html">Drug</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">patient_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="createPatientDataModel.html">createPatientDataModel</a></span><span class="op">(</span><span class="va">drug_combi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">valid_configs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va"><a href="DoseConfiguration-class.html">DoseConfiguration</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">drug_combi</span><span class="op">)</span>, <span class="va"><a href="DoseConfiguration-class.html">DoseConfiguration</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">drug_combi</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calibrate epsilon</span></span></span>
<span class="r-in"><span><span class="va">calibration_results</span> <span class="op">&lt;-</span> <span class="fu">calibrate_epsilon</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dose_configs_valid <span class="op">=</span> <span class="va">valid_configs</span>,</span></span>
<span class="r-in"><span>  epsilon_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  num_simulations <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  drugCombinationModel <span class="op">=</span> <span class="va">drug_combo_model</span>,</span></span>
<span class="r-in"><span>  drugcombi_new <span class="op">=</span> <span class="va">drug_combi</span>,</span></span>
<span class="r-in"><span>  patientDataModel <span class="op">=</span> <span class="va">patient_data</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access the optimal epsilon</span></span></span>
<span class="r-in"><span><span class="va">optimal_epsilon</span> <span class="op">&lt;-</span> <span class="va">calibration_results</span><span class="op">$</span><span class="va">optimal_epsilon</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Xiaoran Lai.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

