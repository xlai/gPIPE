<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the gPIPE Package for Dose-Finding Studies • gPIPE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the gPIPE Package for Dose-Finding Studies">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gPIPE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/gPIPE.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/xlai/gPIPE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the gPIPE Package for Dose-Finding
Studies</h1>
                        <h4 data-toc-skip class="author">Xiaoran
Lai</h4>
            
            <h4 data-toc-skip class="date">2025-03-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/xlai/gPIPE/blob/v0.1.0/vignettes/gPIPE.Rmd" class="external-link"><code>vignettes/gPIPE.Rmd</code></a></small>
      <div class="hidden name"><code>gPIPE.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates the use of the gPIPE package for
dose-finding studies. The package implements a generalized Product of
Independent Beta Probabilities Escalation (PIPE) design with
epsilon-tapering. The key components include:</p>
<ul>
<li>
<code>Drug</code>: Manages drug information and dose levels</li>
<li>
<code>DrugCombination</code>: Handles combinations of drugs and
their dose levels</li>
<li>
<code>DoseConfiguration</code>: Manages dose configurations</li>
<li>
<code>PipeEstimator</code>: Implements the core PIPE
methodology</li>
<li>
<code>PatientDataModel</code>: Tracks patient data throughout the
trial</li>
</ul>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>First, we load the required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/xlai/gPIPE" class="external-link">gPIPE</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="constructors">Constructors<a class="anchor" aria-label="anchor" href="#constructors"></a>
</h2>
<div class="section level3">
<h3 id="drug-class">Drug Class<a class="anchor" aria-label="anchor" href="#drug-class"></a>
</h3>
<p>The Drug class is designed to manage drug information, including its
name and dose levels. It offers a versatile way of initializing drug
data either programmatically or with parameters.</p>
<p>We can create the object directly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a drug with 3 dose levels</span></span>
<span><span class="va">num_doses</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">drugA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrug.html">createDrug</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'drugA'</span>, doseCount <span class="op">=</span> <span class="va">num_doses</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create drugs with specific dose levels and labels</span></span>
<span><span class="va">drug1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrug.html">createDrug</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Drug1'</span>, doseCount <span class="op">=</span> <span class="va">num_doses</span><span class="op">)</span></span>
<span><span class="va">drug2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrug.html">createDrug</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Drug2'</span>, doseCount <span class="op">=</span> <span class="va">num_doses</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a list of drugs for combination use</span></span>
<span><span class="va">drug_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">drug1</span>, <span class="va">drug2</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="working-with-drug-objects">Working with Drug Objects<a class="anchor" aria-label="anchor" href="#working-with-drug-objects"></a>
</h4>
</div>
<div class="section level4">
<h4 id="get-dose-informations">Get dose informations<a class="anchor" aria-label="anchor" href="#get-dose-informations"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get dose labels for Drug1</span></span>
<span><span class="va">drug_labels</span> <span class="op">&lt;-</span> <span class="va">drug1</span><span class="op">$</span><span class="fu">getDoseLabels</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">drug_labels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dose1" "dose2" "dose3"</span></span>
<span></span>
<span><span class="co"># Get numeric level for "dose2" dose level</span></span>
<span><span class="va">dose_levelA</span> <span class="op">&lt;-</span> <span class="va">drugA</span><span class="op">$</span><span class="fu">getDoseLevels</span><span class="op">(</span><span class="st">"dose2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dose_levelA</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span></span>
<span><span class="co"># Add a new dose level</span></span>
<span><span class="va">drugA</span><span class="op">$</span><span class="fu">addDose</span><span class="op">(</span>new_label <span class="op">=</span> <span class="st">"Extra"</span>, new_level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get updated dose labels </span></span>
<span><span class="va">updated_labels</span> <span class="op">&lt;-</span> <span class="va">drugA</span><span class="op">$</span><span class="fu">getDoseLabels</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">updated_labels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dose1" "dose2" "dose3" "Extra"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="drug-combination-class">Drug Combination Class<a class="anchor" aria-label="anchor" href="#drug-combination-class"></a>
</h3>
<p>The <code>DrugCombi</code> class, short for Drug Combination, is
designed for managing combinations of different drugs and their
respective dose levels. It is a composite constructor of multiple drugs
that gives additional methods uniquely defined for drug
combinations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a drug combination object using our list of drugs</span></span>
<span><span class="va">drugcombi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrugCombi.html">createDrugCombi</a></span><span class="op">(</span>drugs <span class="op">=</span> <span class="va">drug_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get all possible dose combinations</span></span>
<span><span class="va">dose_combinations</span> <span class="op">&lt;-</span> <span class="va">drugcombi</span><span class="op">$</span><span class="fu">getDoseCombinationsLevel</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dose_combinations</span><span class="op">)</span></span>
<span><span class="co">#&gt; dose1.dose1 dose1.dose2 dose1.dose3 dose2.dose1 dose2.dose2 dose2.dose3 </span></span>
<span><span class="co">#&gt;           1           2           3           4           5           6 </span></span>
<span><span class="co">#&gt; dose3.dose1 dose3.dose2 dose3.dose3 </span></span>
<span><span class="co">#&gt;           7           8           9</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dose-configuration-class">Dose Configuration Class<a class="anchor" aria-label="anchor" href="#dose-configuration-class"></a>
</h3>
<p>The DoseConfiguration class manages dose configurations for
dose-finding studies. Let’s create valid dose configurations that
satisfy monotonicity constraints:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate monotonic matrices for a dose grid</span></span>
<span><span class="va">num_doses_a</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">num_doses_b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">all_configs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/monotonic_matrices.html">monotonic_matrices</a></span><span class="op">(</span><span class="va">num_doses_a</span>, <span class="va">num_doses_b</span>, <span class="st">"decreasing"</span><span class="op">)</span></span>
<span><span class="va">all_configs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">all_configs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create dose configuration objects</span></span>
<span><span class="va">dose_configs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">all_configs</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/createDoseConfig.html">createDoseConfig</a></span><span class="op">(</span></span>
<span>        drugCombiObject <span class="op">=</span> <span class="va">drugcombi</span>, </span>
<span>        isNonDecreasing <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>        currentConfig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep only valid configurations</span></span>
<span><span class="va">dose_configs_valid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Filter</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">isValid</span>, <span class="va">dose_configs</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pipe-estimator-class">PIPE Estimator Class<a class="anchor" aria-label="anchor" href="#pipe-estimator-class"></a>
</h3>
<p>The PipeEstimator class implements the core PIPE methodology. It
takes a list of valid dose configurations and evaluates the posterior
gain of each configuration. The tuning parameters <code>epsilon</code>
and <code>weight</code> can be fixed or adaptive at each update.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a PIPE estimator with linear tapering</span></span>
<span><span class="va">pipe_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPipeEstimator.html">createPipeEstimator</a></span><span class="op">(</span></span>
<span>    validConfigs <span class="op">=</span> <span class="va">dose_configs_valid</span>, </span>
<span>    epsilonTarget <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    taper_type <span class="op">=</span> <span class="st">'linear'</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="patientdatamodel-class">PatientDataModel Class<a class="anchor" aria-label="anchor" href="#patientdatamodel-class"></a>
</h3>
<p>The PatientDataModel class tracks patient data throughout a
trial:</p>
<p>Create a PatientDataModel object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a patient data model</span></span>
<span><span class="va">patientDataModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPatientDataModel.html">createPatientDataModel</a></span><span class="op">(</span><span class="va">drugcombi</span>, startingDoseLevel <span class="op">=</span> <span class="st">'dose1.dose1'</span><span class="op">)</span></span>
<span><span class="va">patientDataModel</span><span class="op">$</span><span class="fu">resetTrial</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add individual patient data</span></span>
<span><span class="va">patientDataModel</span><span class="op">$</span><span class="fu">addPatientData</span><span class="op">(</span>doseCombination <span class="op">=</span> <span class="st">"dose1.dose1"</span>, outcome <span class="op">=</span> <span class="fl">0</span>, cohort <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">patientDataModel</span><span class="op">$</span><span class="fu">addPatientData</span><span class="op">(</span>doseCombination <span class="op">=</span> <span class="st">"dose2.dose2"</span>, outcome <span class="op">=</span> <span class="fl">1</span>, cohort <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">patientDataModel</span><span class="op">$</span><span class="fu">addPatientData</span><span class="op">(</span>doseCombination <span class="op">=</span> <span class="st">"dose2.dose1"</span>, outcome <span class="op">=</span> <span class="fl">1</span>, cohort <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Summary statistics for each dose level combination can be printed for
furhter processing. We can toggle between printing all dose levels or
only those onto which patients enrolled.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get summary statistics for doses that have patients enrolled</span></span>
<span><span class="va">summaryStats</span> <span class="op">&lt;-</span> <span class="va">patientDataModel</span><span class="op">$</span><span class="fu">getSummaryStats</span><span class="op">(</span>includeAllCombi <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summaryStats</span><span class="op">)</span></span>
<span><span class="co">#&gt; $dose1.dose1</span></span>
<span><span class="co">#&gt; $dose1.dose1$numPatients</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dose1.dose1$numAdverseEvents</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dose2.dose1</span></span>
<span><span class="co">#&gt; $dose2.dose1$numPatients</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dose2.dose1$numAdverseEvents</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dose2.dose2</span></span>
<span><span class="co">#&gt; $dose2.dose2$numPatients</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dose2.dose2$numAdverseEvents</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="co"># Generate random patient data up to a specified dose level</span></span>
<span><span class="va">patientDataModel</span><span class="op">$</span><span class="fu">generateRandomPatientData</span><span class="op">(</span></span>
<span>    doseLevel <span class="op">=</span> <span class="st">"dose2.dose2"</span>,</span>
<span>    numPatients <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    outcomeProb <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View patient data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">patientDataModel</span><span class="op">$</span><span class="va">patientData</span><span class="op">)</span></span>
<span><span class="co">#&gt;   doseCombination outcome cohort</span></span>
<span><span class="co">#&gt; 1     dose1.dose1       0      1</span></span>
<span><span class="co">#&gt; 2     dose2.dose2       1      2</span></span>
<span><span class="co">#&gt; 3     dose2.dose1       1      3</span></span>
<span><span class="co">#&gt; 4     dose2.dose2       0      1</span></span>
<span><span class="co">#&gt; 5     dose2.dose2       0      1</span></span>
<span><span class="co">#&gt; 6     dose2.dose2       0      1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="drug-combination-model-class">Drug Combination Model Class<a class="anchor" aria-label="anchor" href="#drug-combination-model-class"></a>
</h3>
<p>The <code>DrugCombinationModel</code> constructor allows the
initialisation and update of the statistical model used for each drug
combination level. Depending on the model (currently only binomial and
normal distribution for binary and continuous outcomes, respectively) ,
it reads in prior information, including hyperparameters, from a YAML
file, and update the posterior of interest based on the patient data
that are fed into the model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a DrugCombinationModel object with default priors</span></span>
<span><span class="va">config_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>    priorA <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    priorB <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">drugCombinationModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrugCombinationModel.html">createDrugCombinationModel</a></span><span class="op">(</span></span>
<span>    config_list <span class="op">=</span> <span class="va">config_list</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"binomial"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update the model based on patient data</span></span>
<span><span class="va">updatedModel_posterior</span> <span class="op">&lt;-</span> <span class="va">drugCombinationModel</span><span class="op">$</span><span class="fu">updateModel</span><span class="op">(</span><span class="va">patientDataModel</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View a sample of the updated posterior probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">updatedModel_posterior</span><span class="op">)</span></span>
<span><span class="co">#&gt; dose1.dose1 dose1.dose2 dose1.dose3 dose2.dose1 dose2.dose2 dose2.dose3 </span></span>
<span><span class="co">#&gt;  0.66074595  0.36901012  0.36901012  0.07727429  0.74809555  0.36901012</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="pipe-estimator-update">PIPE estimator update<a class="anchor" aria-label="anchor" href="#pipe-estimator-update"></a>
</h2>
<p>Once the posterior for the parameter of interest is calculated, we
can then pass it onto the <code>PipeEstimator</code> to update the
posterior gain to select the best config so far</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Update PIPE estimator with posterior probabilities</span></span>
<span><span class="va">pipe_hat</span><span class="op">$</span><span class="fu">updatePipeEstimator</span><span class="op">(</span><span class="va">updatedModel_posterior</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] -11.54125</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] -10.87463</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] -11.4111</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] -11.94756</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] -13.3546</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] -13.89107</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [1] -14.42753</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] -12.80259</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; [1] -13.33905</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; [1] -13.87552</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[11]]</span></span>
<span><span class="co">#&gt; [1] -13.89107</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[12]]</span></span>
<span><span class="co">#&gt; [1] -14.42753</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[13]]</span></span>
<span><span class="co">#&gt; [1] -14.964</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[14]]</span></span>
<span><span class="co">#&gt; [1] -13.33905</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[15]]</span></span>
<span><span class="co">#&gt; [1] -13.87552</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[16]]</span></span>
<span><span class="co">#&gt; [1] -14.41198</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[17]]</span></span>
<span><span class="co">#&gt; [1] -13.87552</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[18]]</span></span>
<span><span class="co">#&gt; [1] -14.41198</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[19]]</span></span>
<span><span class="co">#&gt; [1] -14.94845</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[20]]</span></span>
<span><span class="co">#&gt; [1] -15.48492</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conducting-a-dual-agent-dose-escalation-trial-using-pipe-design">Conducting a dual-agent dose-escalation trial using PIPE design<a class="anchor" aria-label="anchor" href="#conducting-a-dual-agent-dose-escalation-trial-using-pipe-design"></a>
</h2>
<div class="section level3">
<h3 id="initialisation">Initialisation<a class="anchor" aria-label="anchor" href="#initialisation"></a>
</h3>
<p>Let us first define the dose levels for each drug under investigation
in the trial. This can be done either through reading information from a
YAML file with specific dose levels, or initialised without.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up drugs for the trial</span></span>
<span><span class="va">num_doses_a</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">num_doses_b</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">drugA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrug.html">createDrug</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'drugA'</span>, doseCount <span class="op">=</span> <span class="va">num_doses_a</span><span class="op">)</span></span>
<span><span class="va">drugB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrug.html">createDrug</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'drugB'</span>, doseCount <span class="op">=</span> <span class="va">num_doses_b</span><span class="op">)</span></span>
<span><span class="va">drug_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">drugA</span>, <span class="va">drugB</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create drug combination</span></span>
<span><span class="va">drugcombi_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrugCombi.html">createDrugCombi</a></span><span class="op">(</span>drugs <span class="op">=</span> <span class="va">drug_list</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Get available dose combinations</span></span>
<span><span class="va">dose_combinations</span> <span class="op">&lt;-</span> <span class="va">drugcombi_new</span><span class="op">$</span><span class="fu">getDoseCombinationsLevel</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dose_combinations</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "dose1.dose1" "dose1.dose2" "dose1.dose3" "dose2.dose1" "dose2.dose2"</span></span></code></pre></div>
<p>We will then set up the PIPE configurations and find the set of
configurations that fulfills the partial-order constraint. Note that we
would like our dose configuration to be equal to 1 if it the dose level
is acceptable, and 0 otherwise. This means that we will set
<code>isNonDecreasing = FALSE</code> for non-increasing
configurations.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The gPIPE package provides a comprehensive framework for implementing
the generalized PIPE design with epsilon-tapering for dose-finding
studies. This vignette has demonstrated the key components and workflow
for designing and analyzing such studies.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Mander, A. P., &amp; Sweeting, M. J. (2015). A product of
independent beta probabilities dose escalation design for dual-agent
phase I trials. <em>Statistics in medicine</em>, 34(8), 1261-1276. <a href="doi:10.1002/sim.6434" class="uri">doi:10.1002/sim.6434</a></p></li>
<li><p>Cheung, Y. K., Chandereng, T., &amp; Diaz, K. M. (2022). A novel
framework to estimate multidimensional minimum effective doses using
asymmetric posterior gain and epsilon-tapering. <em>The annals of
applied statistics</em>, 16(3), 1445. <a href="doi:10.1214/21-AOAS1603" class="uri">doi:10.1214/21-AOAS1603</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Xiaoran Lai.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
